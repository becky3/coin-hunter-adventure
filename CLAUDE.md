# CLAUDE.md - コインハンターアドベンチャー開発ルール

このファイルは、Claudeがこのプロジェクトで作業する際の必須ルールを定義しています。

## 📚 関連ドキュメント（必読）

作業開始前に以下のドキュメントを必ず確認してください：

- **README.md** - プロジェクト概要とセットアップ手順
- **docs/PROJECT_STRUCTURE.md** - プロジェクト構造の詳細
- **docs/DEVELOPMENT_GUIDE.md** - 開発ガイドとテスト手順
- **docs/TECHNICAL_SPECS.md** - 技術仕様と制限事項

## 🚀 会話開始時の必須操作

1. **HTTPサーバーを起動**（CORS制限回避のため必須）
   ```bash
   python3 -m http.server 8080
   ```

2. **開発ドキュメントを確認**
   - 上記の関連ドキュメントを読み込む
   - 現在のIssueとPRの状態を確認

## 💻 必須開発ワークフロー

### 1. Issue作業開始前
- **必ずIssueにコメント**: 作業開始の宣言と実装方針を簡潔に記載
- 詳細なやり取りはPRで行う

### 2. 開発中
- **細かくコミット**: 特に破壊的変更は段階的に
- **各ステップでテスト実行**: 自動テストツールを活用

### 3. PR作成前
- **テスト実行必須**: HTTPサーバー経由での動作確認
- **全機能の動作確認**: ゲームプレイが可能であることを確認

### 4. 作業完了時
- **PRを作成**: `gh pr create`コマンドで作成
- **PR本文に記載**: "Closes #<issue-number>"を含める
- **実装内容の報告**: 詳細な変更内容をPRに記載

### 5. 作業終了時
- **HTTPサーバーを停止**: `pkill -f "python3 -m http.server"`

## 🎯 開発時の重要ルール

### コーディング規約
1. **コメントの簡潔性**: 変更履歴や前提条件の詳細な説明は避ける
2. **エラーハンドリング**: 不要なフォールバックは実装しない
3. **依存関係**: 満たされない場合は明確にエラーで終了
4. **デバッグコード**: console.logは本番コードに残さない

### テスト実行ルール
1. **前提条件確認**: `curl-test-validator.js`を必ず実行
2. **自動テスト**: 利用可能な検証ツールをすべて実行
3. **結果の記録**: ユーザー確認完了後のみ記録

### コミットルール
1. **意味のある単位**: 機能追加、バグ修正、リファクタリングを分離
2. **コミットメッセージ**: 日本語で明確に記載
3. **破壊的変更**: 必ず段階的にコミット

## 🛠️ Claude側での確認義務

### 自動実行必須項目
1. **コード解析**
   - 関連ファイルの構文確認
   - 依存関係の検証
   - 非同期処理の流れ確認

2. **自動テスト実行**
   - 検証ツールの実行
   - エラーメッセージの分析
   - 構造チェック

3. **問題の特定と修正**
   - 根本原因の分析
   - 具体的な修正案の提示
   - 修正後の動作予測

### 禁止事項
- ユーザーに確認作業を丸投げ
- デバッグページの作成を強要
- 推測に基づく「確認してください」の多用

## 📋 チェックリスト

作業開始前：
- [ ] HTTPサーバーが起動している
- [ ] 関連ドキュメントを確認した
- [ ] 現在のIssue/PRを確認した

作業中：
- [ ] テストを実行している
- [ ] コミットを適切に分割している
- [ ] エラーハンドリングが適切

作業完了時：
- [ ] すべてのテストが成功
- [ ] PRを作成した
- [ ] ドキュメントを更新した（必要な場合）

## 🔄 継続的改善

このルールは開発の進行に応じて更新されます。重要な変更があった場合は、このファイルも更新してください。